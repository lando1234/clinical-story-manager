# Psychiatric Medical Records System — Use Cases

## Overview

This document describes the primary functional flows for the MVP.

Each use case represents a complete interaction between the clinician and the system.

Use cases are written without assumptions about user interface or implementation.

---

## UC-01: Create Patient

### Description

The clinician registers a new patient in the system to begin documenting their psychiatric care.

### Actor

Clinician

### Trigger

The clinician needs to document care for an individual not yet registered in the system.

### Preconditions

- The system is accessible.
- The clinician has the patient's demographic information available.

### Steps

1. The clinician initiates the patient creation process.
2. The clinician provides the patient's full name.
3. The clinician provides the patient's date of birth.
4. The clinician provides contact information (phone, email, address).
5. The clinician provides emergency contact details (name, phone, relationship).
6. The clinician confirms the patient information.
7. The system creates the Patient record.
8. The system creates an associated ClinicalRecord.
9. The system creates an initial empty PsychiatricHistory (version 1).
10. The system assigns a unique identifier to the patient.
11. The system sets the patient status to active.
12. The system records the registration date.
13. The system confirms successful creation.

### Validations

| Field | Rule |
|-------|------|
| Full name | Required. Cannot be empty. |
| Date of birth | Required. Must be a valid date. Cannot be in the future. |
| Contact phone | Optional. If provided, must be a valid phone format. |
| Contact email | Optional. If provided, must be a valid email format. |
| Emergency contact name | Optional. |
| Emergency contact phone | Optional. Required if emergency contact name is provided. |

### Expected Outcome

- A new Patient exists in the system with active status.
- A ClinicalRecord is associated with the Patient.
- An empty PsychiatricHistory (version 1) exists within the ClinicalRecord. All content fields are initially blank and are populated during the initial evaluation encounter.
- The patient is available for search and documentation.
- No clinical events are generated by patient creation.

### Alternative Flows

**AF-01: Duplicate Detection**

If a patient with the same full name and date of birth already exists:

1. The system alerts the clinician to the potential duplicate.
2. The clinician may proceed with creation or cancel to review the existing patient.

### Error Conditions

- Missing required fields: Creation is blocked until required information is provided.
- Invalid date format: The system requests a valid date.

---

## UC-01B: Edit Patient Information

### Description

The clinician updates a patient's demographic or contact information.

### Actor

Clinician

### Trigger

Patient information has changed, or an error in previously entered data is identified.

### Preconditions

- The patient exists in the system.
- The clinician has accessed the patient's record.

### Steps

1. The clinician initiates patient information editing.
2. The system displays the current patient information.
3. The clinician modifies one or more fields.
4. The clinician confirms the changes.
5. The system updates the Patient record.
6. The system records the modification timestamp.

### Editable Fields

- Full name
- Date of birth
- Contact phone
- Contact email
- Address
- Emergency contact name
- Emergency contact phone
- Emergency contact relationship

### Fields That Cannot Be Edited

- Patient identifier (immutable)
- Registration date (immutable)

### Validations

| Field | Rule |
|-------|------|
| Full name | Required. Cannot be empty. |
| Date of birth | Required. Must be a valid date. Cannot be in the future. |
| Contact phone | Optional. If provided, must be a valid phone format. |
| Contact email | Optional. If provided, must be a valid email format. |
| Emergency contact phone | Optional. Required if emergency contact name is provided. |

### Expected Outcome

- The Patient record reflects the updated information.
- The ClinicalRecord and all contained entities are unaffected.
- No clinical event is generated.

### Alternative Flows

**AF-01: Mark Patient as Inactive**

If the patient is no longer receiving care:

1. The clinician changes the patient status to inactive.
2. The system updates the status.
3. The patient's clinical record remains fully accessible.
4. Inactive patients are distinguished in search results.

**AF-02: Reactivate Inactive Patient**

If an inactive patient returns to care:

1. The clinician changes the patient status to active.
2. The system updates the status.
3. Full documentation capabilities are restored.

### Notes

- Patient editing does not affect clinical documentation.
- The ClinicalRecord and its contents are independent of demographic updates.
- No audit trail of demographic changes is maintained in MVP.

---

## UC-02: Search Patient

### Description

The clinician locates an existing patient to access their clinical record.

### Actor

Clinician

### Trigger

The clinician needs to view or document information for a specific patient.

### Preconditions

- At least one patient exists in the system.

### Steps

1. The clinician initiates a patient search.
2. The clinician enters search criteria.
3. The system searches across patient records.
4. The system returns matching patients ordered by relevance.
5. The clinician reviews the results.
6. The clinician selects the desired patient.
7. The system provides access to the selected patient's ClinicalRecord.

### Search Criteria

The search accepts any of the following:

- Full name (partial match supported)
- Date of birth
- Patient identifier
- Any combination of the above

### Validations

| Criterion | Rule |
|-----------|------|
| Search input | At least one character required. |
| Date of birth | If provided, must be a valid date format. |

### Expected Outcome

- Zero or more patients matching the criteria are returned.
- Results include: patient identifier, full name, date of birth, status.
- Active patients appear before inactive patients.
- The clinician can access the full record of a selected patient.

### Alternative Flows

**AF-01: No Results Found**

If no patients match the search criteria:

1. The system indicates no matching patients were found.
2. The clinician may modify the search criteria or initiate patient creation.

**AF-02: Large Result Set**

If the search returns more than a manageable number of results:

1. The system presents results in a paginated or scrollable format.
2. The clinician may refine search criteria to narrow results.

### Notes

- Search includes both active and inactive patients.
- Inactive patients are visually distinguished in results.
- Search text matches against patient name fields.

---

## UC-03: Add Clinical Note

### Description

The clinician documents a patient encounter by creating a clinical note.

### Actor

Clinician

### Trigger

A clinical encounter has occurred or the clinician is documenting a past encounter.

### Preconditions

- The patient exists in the system.
- The clinician has accessed the patient's ClinicalRecord.

### Steps

1. The clinician initiates note creation for the selected patient.
2. The clinician specifies the encounter date.
3. The clinician selects the encounter type.
4. The system creates a new Note in draft status.
5. The clinician enters subjective observations.
6. The clinician enters objective findings.
7. The clinician enters the assessment.
8. The clinician enters the plan.
9. The clinician reviews the complete note.
10. The clinician chooses to finalize or save as draft.

**If saved as draft:**

11. The system saves the Note in draft status.
12. The note remains editable.
13. No clinical event is generated.

**If finalized:**

11. The system validates all required fields.
12. The system changes the Note status to finalized.
13. The system records the finalization date.
14. The system generates an Encounter clinical event.
15. The event appears on the patient's timeline.
16. The note becomes immutable.

### Encounter Types

- Initial Evaluation
- Follow-up
- Crisis Intervention
- Medication Review
- Therapy Session
- Phone Consultation
- Other

### Validations

| Field | Rule |
|-------|------|
| Encounter date | Required. Must be a valid date. Cannot be in the future. |
| Encounter type | Required. Must be a valid type from the enumerated list. |
| Subjective | Required for finalization. May be empty in draft. |
| Objective | Optional. |
| Assessment | Required for finalization. May be empty in draft. |
| Plan | Required for finalization. May be empty in draft. |

### Expected Outcome

**For Draft:**
- The Note exists in draft status within the ClinicalRecord.
- The Note does not appear on the clinical timeline.
- The Note can be edited or deleted.

**For Finalized:**
- The Note exists in finalized status within the ClinicalRecord.
- An Encounter event appears on the clinical timeline at the encounter date.
- The Note content is immutable.
- Addenda can be attached to the Note.

### Alternative Flows

**AF-01: Edit Draft Note**

If the clinician returns to edit an existing draft:

1. The clinician opens the draft note.
2. The clinician modifies any fields.
3. The clinician saves or finalizes.

**AF-02: Abandon Draft**

If the clinician decides not to complete a draft:

1. The clinician requests deletion of the draft note.
2. The system confirms the intention.
3. The draft is removed from the ClinicalRecord.
4. No trace of the draft remains.

**AF-03: Add Addendum to Finalized Note**

If the clinician needs to supplement a finalized note:

1. The clinician opens the finalized note.
2. The clinician initiates addendum creation.
3. The clinician enters the addendum content.
4. The clinician provides a reason for the addendum.
5. The system attaches the addendum to the note.
6. The addendum is immediately immutable.
7. The addendum is displayed with the parent note.

### Error Conditions

- Finalization with missing required fields: The system identifies missing fields and blocks finalization.
- Future encounter date: The system rejects the date and requests a valid past or current date.

---

## UC-04: Add or Update Medication

### Description

The clinician records a new medication or updates an existing medication's status.

### Actor

Clinician

### Trigger

The clinician has prescribed a new medication, changed a dosage, or discontinued a medication.

### Preconditions

- The patient exists in the system.
- The clinician has accessed the patient's ClinicalRecord.

### Steps — Add New Medication

1. The clinician initiates medication addition.
2. The clinician enters the drug name.
3. The clinician enters the dosage and dosage unit.
4. The clinician enters the frequency.
5. The clinician optionally enters the route of administration.
6. The clinician enters the start date.
7. The clinician enters the prescribing reason.
8. The clinician confirms the medication entry.
9. The system creates the Medication record with active status.
10. The system generates a Medication Start clinical event.
11. The event appears on the patient's timeline at the start date.

### Steps — Modify Dosage or Frequency

1. The clinician selects an existing active medication.
2. The clinician initiates a dosage or frequency change.
3. The clinician enters the new dosage, unit, or frequency.
4. The clinician enters the effective date of the change.
5. The clinician confirms the change.
6. The system discontinues the original Medication record (effective date minus one day).
7. The system creates a new Medication record with the updated values.
8. The system links the new record to the original as a continuation.
9. The system generates a Medication Change clinical event.
10. The event appears on the patient's timeline at the effective date.

### Steps — Discontinue Medication

1. The clinician selects an existing active medication.
2. The clinician initiates discontinuation.
3. The clinician enters the end date.
4. The clinician enters the discontinuation reason.
5. The clinician confirms the discontinuation.
6. The system sets the Medication status to discontinued.
7. The system records the end date and discontinuation reason.
8. The system generates a Medication Stop clinical event.
9. The event appears on the patient's timeline at the end date.

### Validations

| Field | Rule |
|-------|------|
| Drug name | Required. Cannot be empty. |
| Dosage | Required. Must be a positive value. |
| Dosage unit | Required. |
| Frequency | Required. |
| Start date | Required. Must be a valid date. Cannot be in the future for new medications. |
| Prescribing reason | Required. |
| Route of administration | Optional. |
| End date | Required for discontinuation. Must be on or after start date. |
| Discontinuation reason | Required for discontinuation. |

### Expected Outcome

**For New Medication:**
- A Medication record exists with active status.
- A Medication Start event appears on the timeline.
- The medication appears in the patient's current medication list.

**For Dosage Change:**
- The original Medication is discontinued.
- A new Medication record exists with active status.
- A Medication Change event appears on the timeline.
- The medication history shows the complete dosage progression.

**For Discontinuation:**
- The Medication status is discontinued.
- A Medication Stop event appears on the timeline.
- The medication moves from current to historical list.

### Alternative Flows

**AF-01: Backdate Medication Start**

If the clinician documents a medication that was started in the past:

1. The clinician enters the historical start date.
2. All steps proceed normally.
3. The Medication Start event appears at the historical date on the timeline.

**AF-02: Reinstate Previously Discontinued Medication**

If the clinician restarts a previously discontinued medication:

1. The clinician creates a new Medication entry (not a continuation).
2. The drug name matches a previously discontinued medication.
3. The system treats this as a separate prescribing episode.
4. A new Medication Start event is generated.

### Error Conditions

- Missing required fields: The system identifies missing fields and blocks the action.
- End date before start date: The system rejects and requests a valid end date.
- Discontinuing an already discontinued medication: The system indicates the medication is already discontinued.

---

## UC-05: Record Next Appointment

### Description

The clinician records the intended date for the patient's next encounter.

### Actor

Clinician

### Trigger

At the conclusion of an encounter, the clinician and patient agree on a follow-up timeframe.

### Preconditions

- The patient exists in the system.
- The clinician has accessed the patient's record.

### Scope Limitation

Full appointment scheduling with calendar management, reminders, and conflict detection is outside MVP scope.

This use case supports minimal recording of intended follow-up timing.

### Steps

1. The clinician initiates appointment recording for the selected patient.
2. The clinician enters the scheduled date.
3. The clinician optionally enters the scheduled time.
4. The clinician optionally enters the expected duration.
5. The clinician selects the appointment type.
6. The clinician optionally enters notes about the appointment.
7. The clinician confirms the entry.
8. The system creates the Appointment record with scheduled status.
9. The system confirms the appointment was recorded.

### Appointment Types

- Initial Evaluation
- Follow-up
- Crisis Intervention
- Medication Review
- Therapy Session
- Phone Consultation
- Other

### Validations

| Field | Rule |
|-------|------|
| Scheduled date | Required. Must be a valid date. Should be in the future or today. |
| Scheduled time | Optional. If provided, must be a valid time format. |
| Duration | Optional. If provided, must be a positive value. |
| Appointment type | Required. |

### Expected Outcome

- An Appointment record exists for the patient.
- The appointment status is scheduled.
- The appointment is visible when viewing the patient record.
- No clinical event is generated.

### Alternative Flows

**AF-01: Update Existing Appointment**

If an appointment already exists for the patient:

1. The clinician selects the existing appointment.
2. The clinician modifies the date, time, or type.
3. The system updates the appointment record.

**AF-02: Cancel Appointment**

If the appointment is no longer needed:

1. The clinician selects the existing appointment.
2. The clinician changes the status to cancelled.
3. The appointment remains in the record with cancelled status.

**AF-03: Mark Appointment Completed**

When the encounter occurs:

1. The clinician may mark the appointment as completed.
2. This is an administrative action separate from clinical note creation.
3. No automatic linking between appointment and note occurs in MVP.

**AF-04: Mark Appointment as No-Show**

If the patient does not attend:

1. The clinician marks the appointment as no-show.
2. The appointment remains in the record with no-show status.
3. No clinical event is generated.

### Notes

- Appointments serve as a simple reminder mechanism.
- The MVP does not include calendar views, scheduling conflicts, or automated reminders.
- Appointment history is retained but not prominently featured.

---

## UC-06: View Full Patient Timeline

### Description

The clinician reviews the complete chronological history of a patient's psychiatric care.

### Actor

Clinician

### Trigger

The clinician needs to understand the patient's treatment history, review past events, or prepare for an encounter.

### Preconditions

- The patient exists in the system.
- The clinician has accessed the patient's ClinicalRecord.

### Steps

1. The clinician requests the timeline view for the selected patient.
2. The system retrieves all clinical events for the patient.
3. The system orders events according to temporal ordering rules.
4. The system presents the timeline in reverse chronological order (most recent first).
5. The clinician views the event list.
6. For each event, the clinician sees: event date, event type, title, brief description.
7. The clinician may select any event to view full details.
8. The clinician may navigate to earlier or later periods.
9. The clinician may switch to forward chronological order.
10. The clinician may filter by event type.
11. The clinician may search within the timeline.

### Event Detail Navigation

When the clinician selects an event:

**For Encounter Events:**
- The system displays the full clinical note.
- All addenda are displayed following the note.
- The note is read-only.

**For Medication Events:**
- The system displays the medication details.
- For change events, both before and after values are shown.
- For stop events, the discontinuation reason is displayed.

**For Other Events:**
- The system displays the event title and full description.
- The recorded date is shown alongside the event date.

### Timeline Ordering

Events are presented according to the temporal ordering rules defined in `03_timeline.md`:

1. Primary: Event occurrence date (clinical date)
2. Secondary: Recorded date (documentation date)
3. Tertiary: Event type priority

### Filter Options

The clinician may filter the timeline to show only:

- All events (default)
- Encounter events only
- Medication events only
- Hospitalization events only
- Life events only
- History Update events only
- Events within a date range

### Search Within Timeline

The clinician may search for specific content:

1. The clinician enters a search term.
2. The system searches across event titles, descriptions, and linked note content.
3. Matching events are highlighted or filtered.
4. The clinician can navigate directly to matching events.

### Validations

None. This is a read-only operation.

### Expected Outcome

- The clinician sees the complete history of clinical events.
- Events are correctly ordered by occurrence date.
- Navigation to full details is available for each event.
- The timeline reflects all finalized documentation.
- Draft notes do not appear on the timeline.
- Backdated events appear at their clinical occurrence date.

### Alternative Flows

**AF-01: Empty Timeline**

If the patient has no clinical events:

1. The system indicates the timeline is empty.
2. The clinician may initiate documentation (create note, add medication, etc.).

**AF-02: Navigate to Specific Date**

If the clinician needs to find events from a specific period:

1. The clinician specifies a target date or date range.
2. The system scrolls or filters to that period.
3. Events from the specified period are displayed.

**AF-03: View Psychiatric History from Timeline**

If the clinician needs to review background information:

1. The clinician requests the psychiatric history.
2. The system displays the current version.
3. The clinician may view previous versions if they exist.
4. History Update events on the timeline link to the corresponding version.

### Notes

- The timeline is the primary navigation structure for understanding patient history.
- Performance should remain acceptable even for patients with extensive histories.
- The timeline displays events, not raw entities; the event layer provides a consistent view.

---

## UC-07: Record Manual Clinical Event

### Description

The clinician documents a clinically significant event that is not captured by other entities.

### Actor

Clinician

### Trigger

A significant occurrence (hospitalization, life event, or other milestone) must be recorded on the patient's timeline.

### Preconditions

- The patient exists in the system.
- The clinician has accessed the patient's ClinicalRecord.

### Steps

1. The clinician initiates manual event creation for the selected patient.
2. The clinician selects the event type (Hospitalization, Life Event, or Other).
3. The clinician enters the event date.
4. The clinician enters the event title.
5. The clinician enters the event description.
6. The clinician confirms the entry.
7. The system creates the ClinicalEvent.
8. The event appears on the patient's timeline at the specified date.

### Event Types for Manual Entry

- Hospitalization
- Life Event
- Other

### Validations

| Field | Rule |
|-------|------|
| Event type | Required. Must be Hospitalization, Life Event, or Other. |
| Event date | Required. Must be a valid date. Cannot be in the future. |
| Title | Required. Cannot be empty. |
| Description | Optional. |

### Expected Outcome

- A ClinicalEvent exists in the ClinicalRecord.
- The event appears on the timeline at the specified event date.
- The event is immutable once created.

### Notes

- Manual events are used for occurrences outside the clinician's direct care (e.g., external hospitalizations).
- Encounter, Medication, and History Update events are generated by their respective entities and should not be entered manually.

---

## UC-08: Update Psychiatric History

### Description

The clinician updates the patient's psychiatric history to reflect new or revised background information.

### Actor

Clinician

### Trigger

New historical information is disclosed, or existing information requires correction or expansion.

### Preconditions

- The patient exists in the system.
- The clinician has accessed the patient's ClinicalRecord.
- At least one PsychiatricHistory version exists (created at patient registration).

### Steps

1. The clinician requests to update the psychiatric history.
2. The system displays the current version of the psychiatric history.
3. The clinician modifies one or more sections.
4. The clinician reviews the updated content.
5. The clinician confirms the update.
6. The system creates a new PsychiatricHistory version with incremented version number.
7. The system marks the previous version with a superseded date.
8. The system generates a History Update clinical event.
9. The event appears on the patient's timeline.

### Sections Available for Update

- Chief complaint
- History of present illness
- Past psychiatric history
- Past hospitalizations
- Suicide attempt history
- Substance use history
- Family psychiatric history
- Medical history
- Surgical history
- Allergies
- Social history
- Developmental history

### Validations

| Field | Rule |
|-------|------|
| Content | At least one section must contain content for the update to proceed. |

### Expected Outcome

- A new PsychiatricHistory version exists with the updated content.
- The previous version is preserved and accessible.
- A History Update event appears on the clinical timeline.
- The new version is marked as current.

### Alternative Flows

**AF-01: View Previous Versions**

If the clinician needs to review historical versions:

1. The clinician requests version history.
2. The system displays all versions with their creation dates.
3. The clinician may select any version to view its content.
4. Previous versions are read-only.

### Notes

- The initial psychiatric history (version 1) created at patient registration does not generate a History Update event.
- Only subsequent versions generate History Update events.
- All versions are retained indefinitely for historical reference.

---

## Use Case Summary

| ID | Name | Generates Events | Modifies Records |
|----|------|------------------|------------------|
| UC-01 | Create Patient | No | Creates Patient, ClinicalRecord, PsychiatricHistory |
| UC-01B | Edit Patient Information | No | Modifies Patient |
| UC-02 | Search Patient | No | None (read-only) |
| UC-03 | Add Clinical Note | Yes (on finalization) | Creates Note, may create Addendum |
| UC-04 | Add or Update Medication | Yes | Creates or modifies Medication |
| UC-05 | Record Next Appointment | No | Creates or modifies Appointment |
| UC-06 | View Full Patient Timeline | No | None (read-only) |
| UC-07 | Record Manual Clinical Event | Yes | Creates ClinicalEvent |
| UC-08 | Update Psychiatric History | Yes | Creates new PsychiatricHistory version |

---

*Document Version: 1.0*  
*Status: Draft*  
*Sources: 01_specs.md, 02_domain.md, 03_timeline.md*

